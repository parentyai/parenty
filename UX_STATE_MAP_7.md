## UX_STATE_MAP_7（UX状態マップ：7状態・確定使用仕様）

## メタ（固定）

- **SSoT責務**: 本書でいう「7状態」は、`policyDecision.result`（ALLOW/DEGRADED/DENY）を置き換えない。**UXの文面/構造を固定するための“状態マップ（モード）”**としてのみ扱い、SSOT 5章/付録Cの拘束から逸脱しない。
- **想定読者**: Product Owner（非エンジニア） / CTO(GPT) / Engineer(Cursor) / Ops
- **依存SSoT**:
  - `PARENTY_SSOT.md` 5章（UX）
  - `PARENTY_SSOT.md` 3章（Policy Engine）
  - `PARENTY_SSOT.md` 付録C（DEGRADED/DENY文言テンプレ）
  - `PARENTY_SSOT.md` 3-4（失敗時既定動作）
  - `PARENTY_SSOT.md` 5-7（外部依存UX原則）
  - `PARENTY_SSOT.md` 1-5（実行主体と責務境界）
- **生成物**: 7状態ごとの「定義/検知シグナル/最優先目的/MUST/MUST NOT/誤判定事故」と、状態に依存する可変・不変ルール
- **編集禁止領域**:
  - 付録C以外のDEGRADED/DENY文言の作成
  - Policy結果（ALLOW/DEGRADED/DENY）や reasonCode / nextAction の独自追加・変更
  - 本書の状態数（7）と名称（固定）の変更
- **更新ルール**: 変更は必ず `SSOT_CHANGE_DECLARATION.md` で宣言し、PRで Yes/No を明示する（`tools/validate_docs.js` のWARN対象）。
- **変更履歴**:
  - 2026-01-09: 初版
- **関連リンク**: `SSOT_INDEX.md` / `Glossary.md` / `Guides.md` / `SSOT_LINK_MAP.md` / `SSOT_VIOLATION_REGISTRY.md`

---

## 背景

- 非エンジニアが実装レビューを行わない前提で、実装者（Cursor）が「その場の判断」でUXを変える余地を消す必要がある。
- SSOTの拘束（特に 5章・付録C・3-4・5-7）に従いながら、**文面/情報量/構造/CTA**の振る舞いを事前固定する。

---

## 説明

## Section 1：UX状態マップ（7状態・使用仕様）

### 1) ONBOARDING / ANXIETY

- **状態定義（心理・状況）**: 初回または再開直後で、ユーザーが目的/次にやること/入力が必要かを判断できない状態。
- **検知シグナル（例示）**:
  - 初回利用（初回メッセージ、初回同意導線、初回設定導線）に該当する
  - ユーザー入力が「何をすればいい？」等の導線要求（質問の形式が不明確）
- **UXの最優先目的（1つ）**: 次に行う行動を1つに絞って提示する。
- **MUST（必ずやる）**:
  - 次の行動を1つだけ提示する（複数選択肢は並列提示しない）
  - 判断主体がユーザーであることを明示する（SSOT 1-5/1-4の範囲）
  - 失敗時は沈黙しない（SSOT 3-4、付録C参照）
- **MUST NOT（絶対やらない）**:
  - 行動の断定・指示（SSOT 1-4）
  - 追加の属性推定や保存方針の決定をAIに委ねる表現（SSOT 1-5）
- **誤判定した場合のUX事故**:
  - 情報量が多すぎて離脱し、同意/設定が成立しない（結果としてDENY/縮退の常態化）

---

### 2) URGENT

- **状態定義（心理・状況）**: 時間制約が強く、遅延が利用者の不利益につながり得る状態（期限/安全/停止・障害等）。
- **検知シグナル（例示）**:
  - Policy結果が DEGRADED/DENY で、かつ reasonCode が SYSTEM/INCIDENT/STOP/CONSENT 系のいずれかに該当する
  - 運用導線（nextAction/runbookLabel）が即時対応を要求する（SSOT 6-2X/7-2）
- **UXの最優先目的（1つ）**: 誤解なく「今できる最短の安全行動」を1つ提示する。
- **MUST（必ずやる）**:
  - 断定禁止の範囲を守りつつ、次の行動を1つ提示する（付録Cの構造に従う）
  - ベンダー名/内部事情の露出を避ける（SSOT 5-7）
  - 失敗時は reasonCode を残し、必要なら incident に接続される（SSOT 3-4/7-2-1）
- **MUST NOT（絶対やらない）**:
  - 推測で確定情報として提示する
  - 緊急性を誇張する表現（不安を煽る課金UXを含む）（SSOT 1-4）
- **誤判定した場合のUX事故**:
  - 不正確な案内が“確定”として受け取られ、誤行動が発生する

---

### 3) CONFIRMATION

- **状態定義（心理・状況）**: ユーザーが「事実/条件」を確認してから判断したい状態。
- **検知シグナル（例示）**:
  - ユーザー入力が「確認」「どこで見ればいい？」等、一次情報の所在を要求する
  - 情報源の鮮度/未検証が理由で縮退している（SOURCE_* / RISK_SOURCE_*）
- **UXの最優先目的（1つ）**: 公式/一次情報へ到達する導線を提示する。
- **MUST（必ずやる）**:
  - 公式情報への導線を提示する（SSOT 5-7/付録F）
  - 断定禁止（SSOT 1-4/付録C）
- **MUST NOT（絶対やらない）**:
  - 公式確認の代替として結論を断定する
- **誤判定した場合のUX事故**:
  - 誤った確度で意思決定を誘導し、後から訂正不能になる

---

### 4) LEARNING

- **状態定義（心理・状況）**: 目的達成のために、背景条件や判断点を理解したい状態（教育的説明を求める）。
- **検知シグナル（例示）**:
  - ユーザー入力が「理由」「違い」「選択肢」などの構造理解を要求する
- **UXの最優先目的（1つ）**: 判断点を「結論→根拠→補足」の構造で提示する。
- **MUST（必ずやる）**:
  - 結論→根拠→補足の構造で提示する（SSOT 1-1 Provideの形式）
  - 行動指示をしない（SSOT 1-4）
- **MUST NOT（絶対やらない）**:
  - ユーザー属性を推測して一般化した結論を押し付ける
- **誤判定した場合のUX事故**:
  - 説明過多で実行が遅れ、期限や安全上の不利益が出る

---

### 5) POWER_USER

- **状態定義（心理・状況）**: 目的が明確で、最短手順・設定・再利用可能な導線を求める状態。
- **検知シグナル（例示）**:
  - 同種の問い合わせ/設定変更が短期間で反復している（繰り返し操作）
- **UXの最優先目的（1つ）**: 再利用可能な導線（設定/公式/次アクション）を最短で提示する。
- **MUST（必ずやる）**:
  - 既存の設定導線（5-6）や公式導線（5-7/付録F）を優先して提示する
- **MUST NOT（絶対やらない）**:
  - “裏口”の操作や例外を提示する（SSOT 1-5/6-4）
- **誤判定した場合のUX事故**:
  - ユーザーが自力で抜け道を探し、SSOT違反の運用が常態化する

---

### 6) FAILURE / GRAY

- **状態定義（心理・状況）**: 取得/判定/配送/保存のいずれかが失敗し、確定情報の提示ができない状態。
- **検知シグナル（例示）**:
  - reasonCode が SYSTEM/INCIDENT/CONTEXT_PROVIDER_OUTAGE/DELIVERY_FAILURE 系
  - Policy結果が DEGRADED/DENY で、付録Cの縮退テンプレを使用する
- **UXの最優先目的（1つ）**: 沈黙せず、再案内の約束と公式導線を提示する。
- **MUST（必ずやる）**:
  - 付録Cのテンプレ参照のみで提示する（直書き禁止）
  - 公式導線を提示する（5-7）
  - incident/運用導線に接続される（3-4/7-2）
- **MUST NOT（絶対やらない）**:
  - 冷淡・突き放しに見える表現（断定/拒絶だけで終える）
  - 内部障害詳細の露出
- **誤判定した場合のUX事故**:
  - ユーザーが「壊れた」と判断し離脱する（信頼毀損）

---

### 7) TRUST_CHECK

- **状態定義（心理・状況）**: ユーザーが「この情報を信じてよいか」を確認している状態（確度・根拠・責任境界の確認）。
- **検知シグナル（例示）**:
  - ユーザー入力が「本当？」「根拠は？」等の信頼確認
  - SOURCE_* / RISK_SOURCE_* / RISK_POLICY_PROHIBITED のいずれかで縮退している
- **UXの最優先目的（1つ）**: 断定しない範囲で根拠の所在（公式導線）を提示する。
- **MUST（必ずやる）**:
  - 公式導線を提示する（5-7/付録F）
  - 判断主体がユーザーであることを明示する（1-5/1-4）
- **MUST NOT（絶対やらない）**:
  - 越権（AIが最終判断者であるかのような表現）
  - 根拠が無いのに確定として言う
- **誤判定した場合のUX事故**:
  - “保証してくれた”と誤解され、事故時の責任分裂が起きる

---

## Section 2：UX挙動の可変ポイント定義

| 項目 | 状態で変えてよい | 状態に関係なく不変（MUST） | 禁止（MUST NOT） |
| --- | --- | --- | --- |
| 初動文（opener） | 7状態で変えてよい | 断定しない（SSOT 1-4） | 行動指示 |
| 情報量 | 7状態で変えてよい | DEGRADED/DENY は付録Cのみ（直書き禁止） | 状態を理由に付録C外文言を生成 |
| 表現トーン | 7状態で変えてよい | 不安煽り・課金誘導禁止（SSOT 1-4） | 恐怖/焦り誘導 |
| 構造（結論先／構造先） | 状態で変えてよい | 根拠の所在は提示可能（公式導線） | 根拠不在の断定 |
| CTA有無 | 状態で変えてよい | 例外/裏口の提示禁止（SSOT 1-5/6-4） | override を促す導線 |
| 判断主体の明示レベル | 状態で変えてよい | 判断主体はユーザー（SSOT 1-5/1-4） | AIが決めたと誤解される表現 |

---

## Section 3：将来の実装計画（実装しない）

### Phase 1

- **目的**: 7状態の“判定”ではなく、“表示モードの選択”が仕様に従って一意にできる状態にする。
- **新しく導入される概念（コードではない）**: UX状態（7状態）の選択根拠の記録（SSOT条番号参照を含む）。
- **絶対に触ってはいけない既存領域**: Policy結果（3値）、付録B/C、nextAction enum（6-2Z）。
- **非エンジニアがレビューすべき観点**: 7状態が固定名称で使われ、禁止事項が破れていないか。

### Phase 2

- **目的**: 失敗/外部依存/信頼確認の状態で、付録Cと公式導線に必ず戻る動線を固定する。
- **新しく導入される概念（コードではない）**: 失敗分類（3-4）とUX状態（FAILURE/GRAY、TRUST_CHECK）の接続。
- **絶対に触ってはいけない既存領域**: 付録C文言の創作、role/nextActionの追加。
- **非エンジニアがレビューすべき観点**: 内部事情・ベンダー名露出が起きていないか。

### Phase 3

- **目的**: 管理UI操作にSSOT条番号が常に紐づき、未指定操作が保存不可になる前提を整える。
- **新しく導入される概念（コードではない）**: 操作のSSOT条番号指定（本書 Section 1/2 の参照）。
- **絶対に触ってはいけない既存領域**: RBACロール追加、監査ログ削除/改ざん。
- **非エンジニアがレビューすべき観点**: 例外なしでブロックされるか。

### Phase 4

- **目的**: 誤判定事故の検知と再発防止（Violation Registry/Guard Promotion）に接続する。
- **新しく導入される概念（コードではない）**: 誤判定事故の記録（`SSOT_VIOLATION_REGISTRY.md`）と、次回レビューで必ず参照される導線。
- **絶対に触ってはいけない既存領域**: SSOT条文・INDEX・LINK_MAP・GATE の変更。
- **非エンジニアがレビューすべき観点**: 過去事故参照がPR上で必須になっているか。

---

## Section 4：実装前UXレビュー観点

### 状態誤判定によるUX事故

- **なぜ危険か**: 状態により情報量/構造/CTAが変わるため、誤判定は誤誘導になる。
- **仕様でどう防ぐか**: Section 1 の MUST/MUST NOT を固定し、付録C/5-7/3-4へ戻る導線を常に優先する。
- **実装で逸脱したらどう検知するか**: `SSOT_VIOLATION_REGISTRY.md` に記録し、次回PRで参照必須（PRテンプレ）。

### URGENT × 誤情報の危険

- **なぜ危険か**: 緊急性が誤って伝わると誤行動が増える。
- **仕様でどう防ぐか**: 断定禁止・公式導線・付録C参照のみを固定する（SSOT 1-4/5-7/付録C）。
- **実装で逸脱したらどう検知するか**: Violationとして記録し、同種が増えたら Guard Promotion を適用する。

### FAILURE/GRAY の冷酷化

- **なぜ危険か**: “拒否だけ”は信頼毀損につながる。
- **仕様でどう防ぐか**: 沈黙禁止・付録Cテンプレのみ・公式導線提示を必須化（SSOT 3-4/5-7/付録C）。
- **実装で逸脱したらどう検知するか**: 運用者レビュー（Runbook）とViolation記録。

### TRUST_CHECK の越権・断定

- **なぜ危険か**: AIが判断主体だと誤解されると責任分裂が起きる。
- **仕様でどう防ぐか**: 判断主体はユーザー、AIは提案まで（SSOT 1-5/1-4）。
- **実装で逸脱したらどう検知するか**: PR/CIでSSOT参照の欠落をWARNし、Violation記録対象にする。

### POWER_USER の説明過多

- **なぜ危険か**: 目的達成が遅れ、設定や公式導線が埋もれる。
- **仕様でどう防ぐか**: 再利用導線を最短提示、裏口禁止（SSOT 1-5/6-4）。
- **実装で逸脱したらどう検知するか**: レビューで状態別の情報量が固定どおりか確認し、逸脱はViolation記録。

---

## Section 5：自己検証と追加提案（Critic）

### 1) 7状態は過剰か？不足か？

- 過剰/不足の判断は本書で行わない（判断は事前仕様の変更として扱い、宣言が必要）。

### 2) 状態を増やさず吸収できる余地

- 吸収は Section 2 の「可変ポイント」で行う（状態数は固定）。

### 3) 国・文化・ITリテラシー差への耐性

- “説明の構造”と“公式導線”を不変にし、トーン/情報量のみを状態で可変とする（Section 2）。

### 4) それでも足りない場合の状態追加ガード条件

- 状態追加は本書の禁止領域により **不可**。
- 例外なく、`SSOT_CHANGE_DECLARATION.md` に宣言し、SSOT側の合意と更新が行われるまで導入しない。

---

## 結論

- 7状態は Policy結果（3値）を置き換えず、UX文面/構造のモードとして固定する。

---

## 補足

- （特になし）

